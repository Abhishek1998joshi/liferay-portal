definition {

	@summary = "Helper function to add a blog entry via Headless"
	macro _addBlogEntry {
		Variables.assertDefined(parameterList = "${content},${groupId},${title}");

		var portalURL = JSONCompany.getPortalURL();

		if (!(isSet(userEmailAddress))) {
			var userEmailAddress = "test@liferay.com";
		}

		if (!(isSet(userPassword))) {
			var userPassword = "test";
		}

		if (!(isSet(coverImageCaption))) {
			var coverImageCaption = "";
		}

		if (!(isSet(coverImageId))) {
			var coverImageId = "0";
		}

		if (!(isSet(subtitle))) {
			var subtitle = "";
		}

		if (!(isSet(description))) {
			var description = "";
		}

		if (!(isSet(externalReferenceCode))) {
			var externalReferenceCode = "";
		}

		if (isSet(assetTagNames)) {
			var list = ListUtil.newList();

			for (var assetTagName : list "${assetTagNames}") {
				var assetTagName = '''"${assetTagName}"''';

				ListUtil.add("${list}", "${assetTagName}");
			}

			var assetTagNames = ListUtil.toString("${list}");
		}
		else {
			var assetTagNames = "";
		}

		if (!(isSet(assetCategoryIds))) {
			var assetCategoryIds = "0";
		}

		if (!(isSet(viewableBy))) {
			var viewableBy = "Anyone";
		}

		var content = '''<p>${content}</p>''';
		var os = OSDetector.isWindows();

		if ("${os}" == "true") {
			var content = StringUtil.replace("${content}", ">", "^>");

			var content = StringUtil.replace("${content}", "<", "^<");
		}

		var curl = '''
				${portalURL}/o/headless-delivery/v1.0/sites/${groupId}/blog-postings \
				-H accept: application/json \
				-H Content-Type: application/json \
				-u ${userEmailAddress}:${userPassword} \
				-d {
					"alternativeHeadline": "${subtitle}",
					"articleBody": "${content}",
					"headline": "${title}",
					"description": "${description}",
					"externalReferenceCode": "${externalReferenceCode}",
					"image": {
						"caption": "${coverImageCaption}",
						"imageId": ${coverImageId}
					},
					"keywords": [${assetTagNames}],
					"taxonomyCategoryIds": [${assetCategoryIds}],
					"viewableBy": "${viewableBy}"
				}
		''';

		var entryId = JSONCurlUtil.post("${curl}", "$.id");

		return "${entryId}";
	}

	macro _getAllBlogsPostingId {
		var portalURL = JSONCompany.getPortalURL();
		var siteId = JSONGroupAPI._getGroupIdByName(
			groupName = "Guest",
			site = "true");

		var curl = '''
			${portalURL}/o/headless-delivery/v1.0/sites/${siteId}/blog-postings \
  				-u test@liferay.com:test \
				-H accept: application/json
		''';

		var curl = JSONCurlUtil.get("${curl}");

		return "${curl}";
	}

	macro _postBlogsPostingComment {
		Variables.assertDefined(parameterList = "${blogsPostingId},${textComment}");

		var portalURL = JSONCompany.getPortalURL();

		if (!(isSet(CommentExternalReferenceCode))) {
			var externalReferenceCode = "";
		}

		if (!(isSet(parentCommentId))) {
			var parentCommentId = "0";
		}

		var curl = '''
			${portalURL}/o/headless-delivery/v1.0/blog-postings/${blogsPostingId}/comments \
 			 	-u test@liferay.com:test \
				-H Content-Type: application/json
            	-d {
				"creator": {},
				"externalReferenceCode": "${CommentExternalReferenceCode}",
				"parentCommentId": "${parentCommentId}",
				"text": "${textComment}"
				}
		''';

		var curl = JSONCurlUtil.post("${curl}");

		if ("${curl}" == "") {
			fail("FAIL. Cannot add journal article.");
		}

		return "${curl}";
	}

	macro _getBlogsPostingComment {
		Variables.assertDefined(parameterList = "${blogsPostingId}");

		var portalURL = JSONCompany.getPortalURL();

		var curl = '''
			${portalURL}/o/headless-delivery/v1.0/blog-postings/${blogsPostingId}/comments \
 				-u test@liferay.com:test \
				-H accept: application/json
		''';

		var curl = JSONCurlUtil.get("${curl}");

		return "${curl}";
	}

}