definition {

	macro _addDocument {
		Variables.assertDefined(parameterList = "${filePath}");

		var portalURL = JSONCompany.getPortalURL();

		if (isSet(assetLibraryId)) {
			var api = "asset-libraries/${assetLibraryId}/documents";
		}
		else {
			var api = "sites/${siteId}/documents";
		}

		if (!(isSet(externalReferenceCode))) {
			var externalReferenceCode = "";
		}

		var curl = '''
			${portalURL}/o/headless-delivery/v1.0/${api} \
			-u test@liferay.com:test \
			-H Content-Type: multipart/form-data \
            -F document={"externalReferenceCode": "${externalReferenceCode}"} \
			-F file=@${filePath} 
		''';

		var curl = JSONCurlUtil.post("${curl}");

		return "${curl}";
	}

	macro _filterDocumentInAssetLibrary {
		Variables.assertDefined(parameterList = "${assetLibraryId},${filtervalue}");

		var portalURL = JSONCompany.getPortalURL();

		var curl = '''
			${portalURL}/o/headless-delivery/v1.0/asset-libraries/${assetLibraryId}/documents?filter=${filtervalue} \
			-u test@liferay.com:test \
			-H accept: application/json
		''';

		var curl = JSONCurlUtil.get("${curl}");

		return "${curl}";
	}

	macro _getDocumentsByErcInAssetLibrary {
		Variables.assertDefined(parameterList = "${assetLibraryId},${externalReferenceCode}");

		var portalURL = JSONCompany.getPortalURL();

		var curl = '''
			${portalURL}/o/headless-delivery/v1.0/asset-libraries/${assetLibraryId}/documents/by-external-reference-code/${externalReferenceCode} \
			-u test@liferay.com:test \
			-H Content-Type: application/json
		''';

		var curl = JSONCurlUtil.get("${curl}");

		return "${curl}";
	}

	macro addDocumentInAssetLibraryByUploadFile {
		Variables.assertDefined(parameterList = "${assetLibraryId},${filePath}");

		var response = DocumentAPI._addDocument(
			assetLibraryId = "${assetLibraryId}",
			externalReferenceCode = "${externalReferenceCode}",
			filePath = "${filePath}");

		return "${response}";
	}

	macro assertExternalReferenceCodeWithCorrectValue {
		if (!(isSet(expectedExternalReferenceCodeValue))) {
			var contentURL = JSONUtil.getWithJSONPath("${responseToParse}", "$.['contentUrl']");

			var contentURLSubString = StringUtil.extractFirst("${contentURL}", "?");

			var expectedExternalReferenceCodeValue = StringUtil.extractLast("${contentURLSubString}", "/");
		}

		var actualExternalReferenceCodeValue = JSONUtil.getWithJSONPath("${responseToParse}", "$..externalReferenceCode");

		TestUtils.assertEquals(
			actual = "${actualExternalReferenceCodeValue}",
			expected = "${expectedExternalReferenceCodeValue}");
	}

	macro assertProperDocumentTotalCount {
		Variables.assertDefined(parameterList = "${expectedDocumentTotalCount}");

		var response = DocumentAPI._filterDocumentInAssetLibrary(
			assetLibraryId = "${assetLibraryId}",
			filtervalue = "${filtervalue}");

		var actualDocumentTotalCount = JSONUtil.getWithJSONPath("${response}", "$..['totalCount']");

		TestUtils.assertEquals(
			actual = "${actualDocumentTotalCount}",
			expected = "${expectedDocumentTotalCount}");
	}

	macro getDocumentsByErcInAssetLibrary {
		var response = DocumentAPI._getDocumentsByErcInAssetLibrary(
			assetLibraryId = "${assetLibraryId}",
			externalReferenceCode = "${externalReferenceCode}");

		return "${response}";
	}

	macro getIdOfCreatedDocument {
		var response = DocumentAPI.addDocumentInAssetLibraryByUploadFile(
			assetLibraryId = "${assetLibraryId}",
			externalReferenceCode = "${externalReferenceCode}",
			filePath = "${filePath}");

		var documentId = JSONUtil.getWithJSONPath("${response}", "$.['id']");

		return "${documentId}";
	}

}