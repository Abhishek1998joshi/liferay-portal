import com.liferay.gradle.util.FileUtil
import com.liferay.gradle.util.copy.StripPathSegmentsAction

buildCSS {
	imports = =[
		new File(npmInstall.nodeModulesDir, "clay-css/src/scss")
	]
}

p =~'foo'

buildLibSass_Darwin {
	doFirst {
		File libSassDir = new File(temporaryDir, "libsass-${project.libSassVersion}")

		libSassDir.mkdirs()

		File buildShFile = new File(libSassDir, "build.sh")

		buildShFile.write("""\
LIBSASS_VERSION=\"${project.libSassVersion}\"
autoreconf --force --install
./configure --disable-static --disable-tests --enable-shared
make -j5""")
	}

	doLast {
		File gradlewFile = new File(wrapperDir, "gradlew")

		ant.replace(
			failOnNoReplacements: true,
			file: gradlewFile,
			token: '# Escape application args',
			value: '''\
# Escape application args
DEFAULT_JVM_OPTS="$DEFAULT_JVM_OPTS \\\"-Dgradle.user.home=$APP_HOME/.gradle\\\""'''
		)

		ant.replace(
			failOnNoReplacements: true,
			file: gradlewFile,
			token: 'org.gradle.wrapper.GradleWrapperMain "$APP_ARGS"',
			value: 'org.gradle.wrapper.GradleWrapperMain "--init-script=$APP_HOME/modules/init.gradle" "$APP_ARGS"'
		)

		File gradlewBatFile = new File(wrapperDir, "gradlew.bat")

		ant.replace(
			failOnNoReplacements: true,
			file: gradlewBatFile,
			token: '@rem Setup the command line',
			value: '''\
@rem Setup the command line
set DEFAULT_JVM_OPTS=%DEFAULT_JVM_OPTS% "-Dgradle.user.home=%APP_HOME%\\.gradle"'''
		)

		ant.replace(
			failOnNoReplacements: true,
			file: gradlewBatFile,
			token: 'org.gradle.wrapper.GradleWrapperMain %CMD_LINE_ARGS%',
			value: 'org.gradle.wrapper.GradleWrapperMain "--init-script=%APP_HOME%\\modules\\init.gradle" %CMD_LINE_ARGS%'
		)
	}
	inputDirName = "src/.libs"
	inputFileName = "libsass.dylib"
	makeExecutable = "./build.sh"
	outputFileName = "libliferaysass.dylib"
	resourcesDirName = "darwin_universal"
}